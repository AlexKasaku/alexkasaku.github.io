<!DOCTYPE html>
<html>
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Kasaku">
    <title>Storing data in the user profile in Sitecore PowerShell Extensions - Kasaku</title>
    <meta name="author" content="Kasaku Ltd.">
    <meta name="description" content="Learn how to use Sitecore PowerShell Extensions to improve the usability of your scripts by storing data in the user profile.">
    
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/images/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/assets/images/apple-touch-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/assets/images/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/assets/images/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/assets/images/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/assets/images/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/assets/images/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon-180x180.png">
	<link rel="icon" type="image/png" href="/assets/images/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/assets/images/favicon-194x194.png" sizes="194x194">
	<link rel="icon" type="image/png" href="/assets/images/favicon-96x96.png" sizes="96x96">
	<link rel="icon" type="image/png" href="/assets/images/android-chrome-192x192.png" sizes="192x192">
	<link rel="icon" type="image/png" href="/assets/images/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="/assets/images/manifest.json">
	<link rel="shortcut icon" href="/assets/images/favicon.ico">
	<meta name="msapplication-TileColor" content="#333a42">
	<meta name="msapplication-TileImage" content="/assets/images/mstile-144x144.png">
	<meta name="msapplication-config" content="/assets/images/browserconfig.xml">
    <meta name="theme-color" content="#333a42">    
    
    <meta property="og:type"               content="article" />
    <meta property="og:title"              content="Storing data in the user profile in Sitecore PowerShell Extensions - Kasaku" />
    <meta property="og:description"        content="Learn how to use Sitecore PowerShell Extensions to improve the usability of your scripts by storing data in the user profile." />
    <meta property="og:image"              content="http://www.kasaku.co.uk/assets/images/cover.png" />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@kasaku_dev" />
    <meta name="twitter:title" content="Storing data in the user profile in Sitecore PowerShell Extensions - Kasaku" />
    <meta name="twitter:description" content="Learn how to use Sitecore PowerShell Extensions to improve the usability of your scripts by storing data in the user profile." />
    <meta name="twitter:image" content="http://www.kasaku.co.uk/assets/images/favicon-194x194.png" />    
    
    
        <link rel="alternative" type="application/atom+xml" title="RSS" href="atom.xml">
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style.min.css">
    <!--STYLES END-->
    
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-63800320-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

    <body>
        <div id="blog">
            <header id="header">
    <i id="btn-open-sidebar" class="icon-lg icon-bars "></i>
    <h1 class="header-title">
        <a class="header-title-link" href="http://www.kasaku.co.uk">Kasaku</a>
    </h1>
    
</header>
            <nav id="sidebar">
    
    
    <div class="sidebar-logo">
        <h1><span class="rotate">Kasaku</span></h1>
        <h2>Web Development</h2>
    </div>
    
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link" href="http://www.kasaku.co.uk/">
                    
                    <i class="sidebar-button-icon icon-lg icon-home"></i>
                    <span class="sidebar-button-desc hide-md">Home</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link" href="http://www.kasaku.co.uk/all-tags">
                    
                    <i class="sidebar-button-icon icon-lg icon-tags"></i>
                    <span class="sidebar-button-desc hide-md">Tags</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link" href="http://www.kasaku.co.uk/all-archives">
                    
                    <i class="sidebar-button-icon icon-lg icon-archive"></i>
                    <span class="sidebar-button-desc hide-md">Archives</span>
                </a>
        </li>
        
    </ul>
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
            <a  class="sidebar-button-link" href="https://community.sitecore.net/members/alexwashtell_5f00_911378316" target="_blank">
                
                    <i class="sidebar-button-icon icon-lg icon-sitecore"></i>
                    <span class="sidebar-button-desc hide-md">Sitecore</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
            <a  class="sidebar-button-link" href="https://github.com/kasaku" target="_blank">
                
                    <i class="sidebar-button-icon icon-lg icon-github"></i>
                    <span class="sidebar-button-desc hide-md">GitHub</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
            <a  class="sidebar-button-link" href="https://twitter.com/kasaku_dev" target="_blank">
                
                    <i class="sidebar-button-icon icon-lg icon-twitter"></i>
                    <span class="sidebar-button-desc hide-md">Twitter</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
            <a  class="sidebar-button-link" href="https://stackoverflow.com/users/173983/kasaku" target="_blank">
                
                    <i class="sidebar-button-icon icon-lg icon-stack-overflow"></i>
                    <span class="sidebar-button-desc hide-md">Stack Overflow</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
            <a  class="sidebar-button-link" href="mailto://alex@kasaku.co.uk" target="_blank">
                
                    <i class="sidebar-button-icon icon-lg icon-envelope-o"></i>
                    <span class="sidebar-button-desc hide-md">Mail</span>
                </a>
        </li>
        
    </ul>
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link" href="http://www.kasaku.co.uk/atom.xml">
                    
                    <i class="sidebar-button-icon icon-lg icon-rss"></i>
                    <span class="sidebar-button-desc hide-md">RSS</span>
                </a>
        </li>
        
    </ul>
    
</nav>
            <div id="main">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
        <div class="post-header main-content-wrap">
    
        <h1 class="post-title" itemprop="headline">Storing data in the user profile in Sitecore PowerShell Extensions</h1>
    
    <div class="post-meta">
    <time  itemprop="datePublished" content="Wed Jul 19 2017 12:00:00 GMT+0100">
        Jul 19, 2017
    </time>
    
</div>
</div>
    
    <div class="post-content markdown main-content-wrap" itemprop="articleBody">
        <p>Sitecore PowerShell Extensions has a very powerful dialog feature that allows scripts to be written that create dialogs for capturing information from the user.<br><a id="more"></a><br>This feature is used by a great deal of the scripts that come bundled with SPE, such as the broken links report:</p>
<p><img src="/2017/07/19/sitecore-powershell-storing-in-user-profile/spe_brokenlinks.png" alt="Broken links dialog" title="Broken links dialog"></p>

<p>And the package generator:</p>
<p><img src="/2017/07/19/sitecore-powershell-storing-in-user-profile/spe_pkg.png" alt="Package generator dialog" title="Package generator dialog"></p>

<p>If you have a script featuring a dialog that you regularly execute, you might want to have your most recently used values saved, so that next time you execute the script you can skip through the dialog. Fortunately, this is actually quite easy to accomplish.</p>
<h1 id="Using-the-User-Profile"><a href="#Using-the-User-Profile" class="headerlink" title="Using the User Profile"></a>Using the User Profile</h1><p>There are a number of different locations you could use to persist this data. Assuming you wish to save the values on a per-user basis, one of the easiest methods is to use the <a href="https://msdn.microsoft.com/en-us/library/2y3fs9xs.aspx" target="_blank" rel="external">ASP.NET User Profile</a>. This is part of the <a href="https://msdn.microsoft.com/en-us/library/yh26yfzy.aspx" target="_blank" rel="external">ASP.NET Membership Provider</a> that Sitecore’s user management is built upon. Using the profile means that the data will be stored within SQL Server and therefore persisted across multiple browser sessions and machines. Furthermore, the Sitecore API and SPE makes accessing this profile very simple.</p>
<p>Getting the current user and setting / getting a profile value from it couldn’t be simpler:</p>
<figure class="highlight ps"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Get the current user</span></div><div class="line"><span class="variable">$user</span> = Get-User -Current </div><div class="line"></div><div class="line"><span class="comment"># Store a value</span></div><div class="line"><span class="variable">$user</span>.Profile.SetCustomProperty(<span class="string">"mycustomproperty"</span>, <span class="string">"store this please!"</span>)</div><div class="line"></div><div class="line"><span class="comment"># Read a value</span></div><div class="line"><span class="variable">$user</span>.Profile.GetCustomProperty(<span class="string">"mycustomproperty"</span>)</div></pre></td></tr></table></figure>
<p>Straightforward, right?</p>
<h2 id="A-sample-script"><a href="#A-sample-script" class="headerlink" title="A sample script"></a>A sample script</h2><p>Let’s use the above example and apply it to a script that uses a dialog. In this example, we will show a simple dialog with a dropdown list. When the dialog is completed, the value that was selected will be stored in the current user’s profile, ready for next time:</p>
<figure class="highlight ps"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$profileKey</span> = <span class="string">"myScript_savedOption"</span></div><div class="line"><span class="variable">$me</span> = Get-User -Current</div><div class="line"></div><div class="line"><span class="comment"># Read the last saved value from the user profile, if any.</span></div><div class="line"><span class="comment"># This will get set in the dialog as the default value.</span></div><div class="line"><span class="variable">$savedValue</span> = <span class="variable">$me</span>.Profile.GetCustomProperty(<span class="variable">$profileKey</span>)</div><div class="line"></div><div class="line"><span class="variable">$options</span> = [ordered]@&#123;</div><div class="line">    <span class="string">"Option One"</span>=<span class="string">"1"</span></div><div class="line">    <span class="string">"Option Two"</span>=<span class="string">"2"</span></div><div class="line">    <span class="string">"Option Three"</span>=<span class="string">"3"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="variable">$props</span> = @&#123;</div><div class="line">    Parameters = @(</div><div class="line">        @&#123;Name=<span class="string">"chosenOption"</span>; Title=<span class="string">"Choose an option"</span>; Options=<span class="variable">$options</span>; Value=<span class="variable">$savedValue</span>&#125;</div><div class="line">    )</div><div class="line">    Title = <span class="string">"Persistant option selector"</span></div><div class="line">    Description = <span class="string">"Choose an option, your choice will be saved for next time."</span></div><div class="line">    Width = <span class="number">300</span></div><div class="line">    Height = <span class="number">300</span></div><div class="line">    ShowHints = <span class="literal">$true</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="variable">$result</span> = Read-Variable @props </div><div class="line"></div><div class="line"><span class="comment"># Only proceed if the user selected OK in the dialog.</span></div><div class="line"><span class="keyword">if</span>(<span class="variable">$result</span> <span class="nomarkup">-ne</span> <span class="string">"ok"</span>)</div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment"># Save the value in the user profile for next time</span></div><div class="line"><span class="variable">$me</span>.Profile.SetCustomProperty(<span class="variable">$profileKey</span>, <span class="variable">$chosenOption</span>)</div><div class="line"></div><div class="line"><span class="comment"># Can now proceed to use $chosenOption in the script</span></div></pre></td></tr></table></figure>
<p>If you execute the script, you will see that once you have completed the dialog once, the value you last selected is preselected for you the next time you run the script. Easy, right?</p>

        
            
        
    </div>
    <div class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/powershell/">powershell</a> <a class="tag tag--primary tag--small t-link" href="/tags/sitecore/">sitecore</a> <a class="tag tag--primary tag--small t-link" href="/tags/sitecore-powershell-extensions/">sitecore-powershell-extensions</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="icon-angle-left"></i>
                    <span class="hide-xs hide-sm text-small mg-icon-l">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2016/11/21/sitecore-sweep/" data-tooltip="Introducing Sitecore.Sweep">
                
                    <span class="hide-xs hide-sm text-small mg-icon-r">NEXT</span>
                    <i class="icon-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://www.kasaku.co.uk/2017/07/19/sitecore-powershell-storing-in-user-profile/">
                <i class="icon-google-plus"></i>
            </a>
        </li>
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://www.kasaku.co.uk/2017/07/19/sitecore-powershell-storing-in-user-profile/">
                <i class="icon-facebook-official"></i>
            </a>
        </li>
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://www.kasaku.co.uk/2017/07/19/sitecore-powershell-storing-in-user-profile/">
                <i class="icon-twitter"></i>
            </a>
        </li>
    </ul>
</div>


        
            <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        <img style="vertical-align:middle" src="/assets/images/favicon-32x32.png"/>
        Copyright &copy; 2017 Kasaku Ltd. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div class="post-bottom-bar">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="icon-angle-left"></i>
                    <span class="hide-xs hide-sm text-small mg-icon-l">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2016/11/21/sitecore-sweep/" data-tooltip="Introducing Sitecore.Sweep">
                
                    <span class="hide-xs hide-sm text-small mg-icon-r">NEXT</span>
                    <i class="icon-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://www.kasaku.co.uk/2017/07/19/sitecore-powershell-storing-in-user-profile/">
                <i class="icon-google-plus"></i>
            </a>
        </li>
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://www.kasaku.co.uk/2017/07/19/sitecore-powershell-storing-in-user-profile/">
                <i class="icon-facebook-official"></i>
            </a>
        </li>
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://www.kasaku.co.uk/2017/07/19/sitecore-powershell-storing-in-user-profile/">
                <i class="icon-twitter"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
            
        </div>
        <div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="icon-remove"></i>
        </div>
        
            <h4 id="about-card-name">Kasaku Ltd.</h4>
        
        
        
    </div>
</div>
        	
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script.min.js"></script>
<!--SCRIPTS END-->

    <script type="text/javascript">
        var disqus_shortname = 'kasaku';
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>


</html>