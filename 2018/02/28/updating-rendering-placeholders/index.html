<!DOCTYPE html>
<html>
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="Kasaku">
    <title>Updating rendering placeholders using Sitecore PowerShell Extensions - Kasaku</title>
    <meta name="author" content="Kasaku Ltd.">
    <meta name="description" content="Kasaku, a Sitecore consultancy outfit based in London, UK.">
    
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/images/apple-touch-icon-57x57.png">
	<link rel="apple-touch-icon" sizes="60x60" href="/assets/images/apple-touch-icon-60x60.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/images/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="76x76" href="/assets/images/apple-touch-icon-76x76.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/assets/images/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" sizes="120x120" href="/assets/images/apple-touch-icon-120x120.png">
	<link rel="apple-touch-icon" sizes="144x144" href="/assets/images/apple-touch-icon-144x144.png">
	<link rel="apple-touch-icon" sizes="152x152" href="/assets/images/apple-touch-icon-152x152.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon-180x180.png">
	<link rel="icon" type="image/png" href="/assets/images/favicon-32x32.png" sizes="32x32">
	<link rel="icon" type="image/png" href="/assets/images/favicon-194x194.png" sizes="194x194">
	<link rel="icon" type="image/png" href="/assets/images/favicon-96x96.png" sizes="96x96">
	<link rel="icon" type="image/png" href="/assets/images/android-chrome-192x192.png" sizes="192x192">
	<link rel="icon" type="image/png" href="/assets/images/favicon-16x16.png" sizes="16x16">
	<link rel="manifest" href="/assets/images/manifest.json">
	<link rel="shortcut icon" href="/assets/images/favicon.ico">
	<meta name="msapplication-TileColor" content="#333a42">
	<meta name="msapplication-TileImage" content="/assets/images/mstile-144x144.png">
	<meta name="msapplication-config" content="/assets/images/browserconfig.xml">
    <meta name="theme-color" content="#333a42">    
    
    <meta property="og:type"               content="article" />
    <meta property="og:title"              content="Updating rendering placeholders using Sitecore PowerShell Extensions - Kasaku" />
    <meta property="og:description"        content="Kasaku, a Sitecore consultancy outfit based in London, UK." />
    <meta property="og:image"              content="https://www.kasaku.co.uk/assets/images/cover.png" />

    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@kasaku_dev" />
    <meta name="twitter:title" content="Updating rendering placeholders using Sitecore PowerShell Extensions - Kasaku" />
    <meta name="twitter:description" content="Kasaku, a Sitecore consultancy outfit based in London, UK." />
    <meta name="twitter:image" content="https://www.kasaku.co.uk/assets/images/favicon-194x194.png" />    
    
    
        <link rel="alternative" type="application/atom+xml" title="RSS" href="atom.xml">
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style.min.css">
    <!--STYLES END-->
    
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-63800320-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


</head>

    <body>
        <div id="blog">
            <header id="header">
    <i id="btn-open-sidebar" class="icon-lg icon-bars "></i>
    <h1 class="header-title">
        <a class="header-title-link" href="https://www.kasaku.co.uk">Kasaku</a>
    </h1>
    
</header>
            <nav id="sidebar">
    
    
    <div class="sidebar-logo">
        <h1><span class="rotate">Kasaku</span></h1>
        <h2>Web Development</h2>
    </div>
    
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link" href="https://www.kasaku.co.uk/">
                    
                    <i class="sidebar-button-icon icon-lg icon-home"></i>
                    <span class="sidebar-button-desc hide-md">Home</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link" href="https://www.kasaku.co.uk/all-tags">
                    
                    <i class="sidebar-button-icon icon-lg icon-tags"></i>
                    <span class="sidebar-button-desc hide-md">Tags</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link" href="https://www.kasaku.co.uk/all-archives">
                    
                    <i class="sidebar-button-icon icon-lg icon-archive"></i>
                    <span class="sidebar-button-desc hide-md">Archives</span>
                </a>
        </li>
        
    </ul>
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
            <a  class="sidebar-button-link" href="https://community.sitecore.net/members/alexwashtell_5f00_911378316" target="_blank">
                
                    <i class="sidebar-button-icon icon-lg icon-sitecore"></i>
                    <span class="sidebar-button-desc hide-md">Sitecore</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
            <a  class="sidebar-button-link" href="https://github.com/kasaku" target="_blank">
                
                    <i class="sidebar-button-icon icon-lg icon-github"></i>
                    <span class="sidebar-button-desc hide-md">GitHub</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
            <a  class="sidebar-button-link" href="https://twitter.com/kasaku_dev" target="_blank">
                
                    <i class="sidebar-button-icon icon-lg icon-twitter"></i>
                    <span class="sidebar-button-desc hide-md">Twitter</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
            <a  class="sidebar-button-link" href="https://stackoverflow.com/users/173983/kasaku" target="_blank">
                
                    <i class="sidebar-button-icon icon-lg icon-stack-overflow"></i>
                    <span class="sidebar-button-desc hide-md">Stack Overflow</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
            <a  class="sidebar-button-link" href="mailto://alex@kasaku.co.uk" target="_blank">
                
                    <i class="sidebar-button-icon icon-lg icon-envelope-o"></i>
                    <span class="sidebar-button-desc hide-md">Mail</span>
                </a>
        </li>
        
    </ul>
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link" href="https://www.kasaku.co.uk/atom.xml">
                    
                    <i class="sidebar-button-icon icon-lg icon-rss"></i>
                    <span class="sidebar-button-desc hide-md">RSS</span>
                </a>
        </li>
        
    </ul>
    
</nav>
            <div id="main">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
        <div class="post-header main-content-wrap">
    
        <h1 class="post-title" itemprop="headline">Updating rendering placeholders using Sitecore PowerShell Extensions</h1>
    
    <div class="post-meta">
    <time  itemprop="datePublished" content="Wed Feb 28 2018 10:00:00 GMT+0000">
        Feb 28, 2018
    </time>
    
</div>
</div>
    
    <div class="post-content markdown main-content-wrap" itemprop="articleBody">
        <p>Just a short blog post today to share a Sitecore PowerShell script that I’ve recently found useful.<br><a id="more"></a><br>On a recent project, we took the decision to rework how we had been using placeholders across the site. This involved retiring a large number of placeholders that were currently in use, and replacing these with a much smaller set. Whilst everyone recognised the need to do this, the appetite for the work involved in updating the existing content was slim.</p>
<p>Fortunately, this sort of grunt work is just what SPE is perfect for. It didn’t take long to put a script together, and within minutes all of the content was updated. I’m sharing it in this post in case someone else finds it useful.</p>
<p>In our situation, we needed something that would process content items, find renderings that were on placeholder <em>X</em> and then update these to set the placeholder as <em>Y</em>. We also wanted to make sure that renderings on placeholders <em>within</em> those renderings were also catered for (e.g. a rendering on placeholder <em>X/A</em> would translate to <em>Y/A</em>). Further to this, we actually had a number of placeholder “mappings” such as this that we wanted updating all in one go.</p>
<p>This is the script that fixed the content:</p>
<figure class="highlight ps"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="variable">$placeholderMappings</span> = @(</div><div class="line"> @(<span class="string">"/old-placeholder"</span>,<span class="string">"/new-placeholder"</span>),</div><div class="line"> @(<span class="string">"/another-old-placeholder"</span>,<span class="string">"/new-placeholder"</span>)</div><div class="line">)</div><div class="line"></div><div class="line"><span class="variable">$rootItem</span> = <span class="built_in">Get-Item</span> -Path master:/sitecore/content/Home</div><div class="line"><span class="variable">$defaultLayout</span> = Get-LayoutDevice <span class="string">"Default"</span></div><div class="line"></div><div class="line"><span class="comment"># Toggle for whether to update Shared or Final Layout</span></div><div class="line"><span class="variable">$useFinalLayout</span> = <span class="literal">$True</span></div><div class="line"></div><div class="line"><span class="comment"># If set to true, the script will only list the renderings that need fixing, rather than fixing them.</span></div><div class="line"><span class="variable">$reportOnly</span> = <span class="literal">$False</span></div><div class="line"></div><div class="line"><span class="keyword">foreach</span> ( <span class="variable">$item</span> <span class="keyword">in</span> <span class="built_in">Get-ChildItem</span> -Item <span class="variable">$rootItem</span> -Recurse )</div><div class="line">&#123;</div><div class="line">    <span class="comment"># Only interested in items that have a layout</span></div><div class="line">    <span class="keyword">if</span> (Get-Layout <span class="variable">$item</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">foreach</span>( <span class="variable">$mapping</span> <span class="keyword">in</span> <span class="variable">$placeholderMappings</span> )</div><div class="line">        &#123;</div><div class="line">            <span class="comment"># Get renderings in this item that have renderings in the placeholder we want to update </span></div><div class="line">            <span class="variable">$renderings</span> =  Get-Rendering -Item <span class="variable">$item</span> -Placeholder (<span class="variable">$mapping</span>[<span class="number">0</span>] + <span class="string">'/*'</span>) -Device <span class="variable">$defaultLayout</span> -FinalLayout:<span class="variable">$useFinalLayout</span></div><div class="line">            </div><div class="line">            <span class="keyword">foreach</span> ( <span class="variable">$rendering</span> <span class="keyword">in</span> <span class="variable">$renderings</span> )</div><div class="line">            &#123;</div><div class="line">                <span class="comment"># Only update the rendering if we're not in "Report Only" mode</span></div><div class="line">                <span class="keyword">if</span> (!<span class="variable">$reportOnly</span>)</div><div class="line">                &#123;</div><div class="line">                   <span class="comment"># Update the placeholder in the rendering and set it back in the item</span></div><div class="line">                   <span class="variable">$rendering</span>.Placeholder = <span class="variable">$rendering</span>.Placeholder <span class="nomarkup">-replace</span> <span class="variable">$mapping</span>[<span class="number">0</span>], <span class="variable">$mapping</span>[<span class="number">1</span>]</div><div class="line">                   Set-Rendering -Item <span class="variable">$item</span> -Instance <span class="variable">$rendering</span> -FinalLayout:<span class="variable">$useFinalLayout</span></div><div class="line">                &#125;</div><div class="line"></div><div class="line">                <span class="built_in">Write-Host</span> <span class="string">"$(<span class="variable">$item</span>.FullPath) - Rendering $(<span class="variable">$rendering</span>.UniqueID) - Placeholder: $(<span class="variable">$mapping</span>[0]) --&gt; $(<span class="variable">$mapping</span>[1])"</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>That’s all there is to it. The general flow of the script is:</p>
<ul>
<li>Recurse through all items with layouts in the content folder specified</li>
<li>For each placeholder mapping specified:<ul>
<li>Get any renderings that match the old placeholder (an exact match or ones that begin with it)</li>
<li>Replace the old placeholder with the new one</li>
<li>Set the rendering back into the item</li>
</ul>
</li>
</ul>
<p>There are two variables you can tweak in the script: one for determining whether to update the Shared or Final Layout, and the other to run the script in “Report Mode” where it will just find items that require changes, without actually going ahead and making the update.</p>
<p>I hope that proves useful to someone!</p>

        
            
        
    </div>
    <div class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/powershell/">powershell</a> <a class="tag tag--primary tag--small t-link" href="/tags/sitecore/">sitecore</a> <a class="tag tag--primary tag--small t-link" href="/tags/sitecore-powershell-extensions/">sitecore-powershell-extensions</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="icon-angle-left"></i>
                    <span class="hide-xs hide-sm text-small mg-icon-l">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/11/22/virtual-user-custom-properties/" data-tooltip="Virtual Users, custom properties and persisting data">
                
                    <span class="hide-xs hide-sm text-small mg-icon-r">NEXT</span>
                    <i class="icon-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://www.kasaku.co.uk/2018/02/28/updating-rendering-placeholders/">
                <i class="icon-google-plus"></i>
            </a>
        </li>
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.kasaku.co.uk/2018/02/28/updating-rendering-placeholders/">
                <i class="icon-facebook-official"></i>
            </a>
        </li>
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://www.kasaku.co.uk/2018/02/28/updating-rendering-placeholders/">
                <i class="icon-twitter"></i>
            </a>
        </li>
    </ul>
</div>


        
            <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        <img style="vertical-align:middle" src="/assets/images/favicon-32x32.png"/>
        Copyright &copy; 2018 Kasaku Ltd. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div class="post-bottom-bar">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--disabled">
                
                    <i class="icon-angle-left"></i>
                    <span class="hide-xs hide-sm text-small mg-icon-l">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2017/11/22/virtual-user-custom-properties/" data-tooltip="Virtual Users, custom properties and persisting data">
                
                    <span class="hide-xs hide-sm text-small mg-icon-r">NEXT</span>
                    <i class="icon-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=https://www.kasaku.co.uk/2018/02/28/updating-rendering-placeholders/">
                <i class="icon-google-plus"></i>
            </a>
        </li>
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://www.kasaku.co.uk/2018/02/28/updating-rendering-placeholders/">
                <i class="icon-facebook-official"></i>
            </a>
        </li>
        <li class="post-action">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://www.kasaku.co.uk/2018/02/28/updating-rendering-placeholders/">
                <i class="icon-twitter"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
            
        </div>
        <div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="icon-remove"></i>
        </div>
        
            <h4 id="about-card-name">Kasaku Ltd.</h4>
        
        
        
    </div>
</div>
        	
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script.min.js"></script>
<!--SCRIPTS END-->

    <script type="text/javascript">
        var disqus_shortname = 'kasaku';
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>


</html>